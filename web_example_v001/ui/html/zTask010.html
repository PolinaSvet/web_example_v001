<!DOCTYPE html>
<html lang="en">
{{template "block_head"}}
<body class="bg-gray-100 font-family-karla flex">
	{{template "block_left_menu"}}
    <div class="relative w-full flex flex-col h-screen overflow-y-hidden">
        {{template "block_desktop_header"}}
        <!-- Desktop Header -->
        <div class="w-full h-screen overflow-x-hidden border-t flex flex-col">
            <main class="w-full flex-grow p-6">
                <h1 class="text-3xl text-black pb-6">{{.PageDescribe}}</h1>
                <h3 class="text-3xl text-black pb-6">{{.PageName}}</h3>

                <!-- Content Start -->
 
                <div class="tab">
                  <button class="tablinks" onclick="openObj(event, 'Task_17_3_1')">17.3.1</button>
                  <button class="tablinks" onclick="openObj(event, 'Task_17_3_2')">17.3.2</button>
                  <button class="tablinks" onclick="openObj(event, 'Task_17_6_1')">17.6.1</button>
                  <button class="tablinks" onclick="openObj(event, 'Task_17_6_2')">17.6.2</button>
                  <button class="tablinks" onclick="openObj(event, 'Task_17_6_3')">17.6.3</button>
                  <button class="tablinks" onclick="openObj(event, 'Task_17_7_1')">17.7.1</button>
                </div>
                
                <div id="Task_17_3_1" class="tabcontent">
                  <h3>1/2) Задание 17.3.1 (HW-04)</h3>
                  <p>Напишите программу, аналогичную той, что мы только что написали, однако она должна использовать уже не 1000 горутин, а только 10.</p>
                  <br>
                  <button type="submit" onclick="startChannel(1)" class="inline-flex items-center py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить
                  </button>
                </div>
                
                <div id="Task_17_3_2" class="tabcontent">
                  <h3>2/2) Задание 17.3.2 (HW-04)</h3>
                  <p>Перепишите приведённый выше пример со счётчиком из основного текста, но вместо примитивов из пакета atomic используйте условную переменную и попробуйте реализовать динамическую проверку достижения конечного значения счётчиком.</p>
                  <br>
                  <button type="submit" onclick="startChannel(2)" class="inline-flex items-center py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить
                  </button>
                </div>

                <div id="Task_17_6_1" class="tabcontent">
                  <h3>1/3) Задание 17.6.1 (HW-04)</h3>
                  <p>Напишите код, в котором имеются два канала сообщений из целых чисел, так, чтобы приём сообщений из них никогда не приводил к блокировке и чтобы вероятность приёма сообщения из первого канала была выше в 2 раза, чем из второго.</p>
                  <p>*Если хотите, можете написать код, который бы демонстрировал это соотношение.</p>
                  <br>
                  <button type="submit" onclick="startChannel(3)" class="inline-flex items-center py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить/Остановить
                  </button>
                </div>

                <div id="Task_17_6_2" class="tabcontent">
                  <h3>2/3) Задание 17.6.2 (HW-04)</h3>
                  <p>Напишите код, в котором имеются два канала сообщений из целых чисел так, чтобы приём сообщений всегда приводил к блокировке.</p>
                  <p>Приёмом сообщений из обоих каналов будет заниматься главная горутина.</p>
                  <p>Сделайте так, чтобы во время такого «бесконечного ожидания» сообщений выполнялась фоновая работа в виде вывода текущего времени в консоль.</p>
                  <br>
                  <button type="submit" onclick="startChannel(4)" class="inline-flex items-center py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить/Остановить
                  </button>
                </div>

                <div id="Task_17_6_3" class="tabcontent">
                  <h3>3/3) Задание 17.6.3 (HW-04)</h3>
                  <p>Напишите программу, которая делает следующее: одна горутина по порядку отсылает числа от 1 до 100 в канал, вторая горутина их принимает в правильном порядке и печатает на экран (в консоль).</p>
                  <br>
                  <button type="submit" onclick="startChannel(5)" class="inline-flex items-center py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить
                  </button>
                </div>

                <div id="Task_17_7_1" class="tabcontent">
                  <h3>1/1) Задание 17.7.1 (HW-04)</h3>
                  <p>Напишите код, в котором несколько горутин увеличивают значение целочисленного счётчика и синхронизируют свою работу через канал.</p>
                  <p>Нужно предусмотреть возможность настройки количества используемых горутин и конечного значения счётчика, до которого его следует увеличивать.</p>
                  <br>
                  <div class="relative">
                    <input type="number" value="100" id="inputPar1" class="block rounded-t-lg px-2.5 pb-1.5 pt-4 w-32 text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " />
                    <label for="inputPar1" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-3 scale-75 top-3 z-10 origin-[0] start-2.5 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto">maxValue:</label>
                  </div>
                  <br>
                  <div class="relative">
                    <input type="number" value="5" id="inputPar2" class="block rounded-t-lg px-2.5 pb-1.5 pt-4 w-32 text-sm text-gray-900 bg-gray-50 dark:bg-gray-700 border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " />
                    <label for="inputPar2" class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-3 scale-75 top-3 z-10 origin-[0] start-2.5 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-3 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto">numGoroutines:</label>
                  </div>
                  <br>
                  <button type="submit" onclick="startChannel(6)" class="inline-flex items-center w-32 py-2.5 px-4 text-xs font-medium text-center border-gray-200 text-gray-700 bg-gray-200 rounded-lg focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-200 hover:bg-blue-100">
                    Запустить
                  </button>
                </div>

                <br>
                <textarea id="data" class="read-only:bg-gray-100 border border-slate-300 w-full h-full max-h-80 px-0 text-sm text-gray-900 bg-white border-0 dark:bg-gray-800 focus:ring-0 dark:text-white dark:placeholder-gray-400" readonly placeholder="Вывод данных..." required></textarea>
                <br>

                <script>
                    var eventSource = new EventSource('/dataChannel');
                    var dataElement = document.getElementById('data');

                    eventSource.onmessage = function(event) {
                        var msg =  dataElement.value;
                        //dataElement.value = event.data + '\r\n'+msg;
                        dataElement.value += event.data + '\r\n';
                    };

                    function clearData() {
                      dataElement.value = '';
                    };

                    function startChannel(channelNum) {
                      clearData();

                      if (channelNum == 6) {
                        var inputPar1 = document.getElementById('inputPar1').value;
                        var inputPar2 = document.getElementById('inputPar2').value;
                        fetch('/start?channel=' + channelNum+'&par1='+inputPar1+'&par2='+inputPar2);
                      }
                      else{ fetch('/start?channel=' + channelNum);  }
                    };

                    function stopChannel(channelNum) {
                      clearData();
                      fetch('/stop?channel=' + channelNum);
                    };

                    window.onbeforeunload = function(e) {
                      stopChannel(1);
                    };


                    function openObj(evt, objName) {
                      var i, tabcontent, tablinks;
                      tabcontent = document.getElementsByClassName("tabcontent");
                      for (i = 0; i < tabcontent.length; i++) {
                        tabcontent[i].style.display = "none";
                      }
                      tablinks = document.getElementsByClassName("tablinks");
                      for (i = 0; i < tablinks.length; i++) {
                        tablinks[i].className = tablinks[i].className.replace(" active", "");
                      }
                      document.getElementById(objName).style.display = "block";
                      evt.currentTarget.className += " active";
                    }


                </script>

                                
              
              <!-- Content End -->

            </main>
    
            {{template "block_footer"}}
        </div>
    </div>
    {{template "block_script"}}
</body>
</html>
